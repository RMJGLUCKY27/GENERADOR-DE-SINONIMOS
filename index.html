<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RISOLU - Generador de Sin√≥nimos para Productos Industriales</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>üè≠ RISOLU - Generador de Sin√≥nimos</h1>
            <p>Optimiza la b√∫squeda de productos industriales con sin√≥nimos inteligentes</p>
            <small>Especializado en Automatizaci√≥n, Redes Industriales y Equipo El√©ctrico</small>
            <div class="api-status-container">
                <div class="api-control-panel">
                    <span id="apiStatus" class="api-status disconnected">Verificando API...</span>
                    <div class="api-controls">
                        <button id="startApiBtn" class="btn-api-control start" onclick="startAPI()" disabled>
                            ‚ñ∂Ô∏è Iniciar API
                        </button>
                        <button id="stopApiBtn" class="btn-api-control stop" onclick="stopAPI()" disabled>
                            ‚èπÔ∏è Detener API
                        </button>
                        <button id="restartApiBtn" class="btn-api-control restart" onclick="restartAPI()" disabled>
                            üîÑ Reiniciar API
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <div class="upload-section">
            <div class="upload-box" id="uploadBox">
                <input type="file" id="fileInput" accept=".xlsx,.xls,.csv" style="display: none;">
                <div class="upload-content">
                    <div class="upload-icon">üìä</div>
                    <p>Arrastra y suelta tu archivo Excel aqu√≠</p>
                    <p>o <button class="btn-upload" onclick="document.getElementById('fileInput').click()">Selecciona un archivo</button></p>
                    <small>Formatos soportados: .xlsx, .xls, .csv</small>
                </div>
            </div>
        </div>

        <div class="controls-section" id="controlsSection" style="display: none;">
            <h3>üìã Vista Previa del Archivo y Selecci√≥n de Columnas</h3>
            
            <!-- Vista previa de datos -->
            <div class="preview-container">
                <div class="preview-info">
                    <span id="fileInfo">Archivo cargado: <strong id="fileName"></strong></span>
                    <span id="rowCount">Filas: <strong id="totalRows"></strong></span>
                </div>
                
                <div class="preview-table-container">
                    <table id="previewTable" class="preview-table">
                        <thead id="previewHeader"></thead>
                        <tbody id="previewBody"></tbody>
                    </table>
                </div>
            </div>
            
            <!-- Controles de selecci√≥n -->
            <div class="column-selection">
                <div class="selection-instructions">
                    <h4>üëÜ Haz clic en los encabezados de columna para seleccionarlas:</h4>
                    <div class="selection-indicators">
                        <span class="indicator alias-indicator">üè∑Ô∏è Alias/C√≥digo</span>
                        <span class="indicator description-indicator">üìù Descripci√≥n</span>
                    </div>
                </div>
                
                <div class="selected-columns">
                    <div class="selected-column">
                        <label>Columna de Alias/C√≥digo:</label>
                        <span id="selectedAlias" class="selected-value">Ninguna seleccionada</span>
                    </div>
                    <div class="selected-column">
                        <label>Columna de Descripci√≥n:</label>
                        <span id="selectedDescription" class="selected-value">Ninguna seleccionada</span>
                    </div>
                </div>
                
                <button class="btn-process" id="processBtn" onclick="generateSynonyms()" disabled>
                    Generar Sin√≥nimos
                </button>
            </div>
        </div>

        <div class="search-section" id="searchSection" style="display: none;">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Buscar productos, alias o sin√≥nimos...">
                <button class="btn-search" onclick="searchProducts()">üîç</button>
            </div>
            <div class="filter-options">
                <label>
                    <input type="checkbox" id="searchAlias" checked> Buscar en alias
                </label>
                <label>
                    <input type="checkbox" id="searchDescription" checked> Buscar en descripci√≥n
                </label>
                <label>
                    <input type="checkbox" id="searchSynonyms" checked> Buscar en sin√≥nimos
                </label>
            </div>
        </div>

        <div class="results-section" id="resultsSection" style="display: none;">
            <div class="results-header">
                <h2>Resultados <span id="resultsCount"></span></h2>
                <div class="export-options">
                    <button class="btn-export" onclick="exportResults('excel')">üìä Exportar a Excel</button>
                    <button class="btn-export" onclick="exportResults('csv')">üìÑ Exportar a CSV</button>
                </div>
            </div>
            <div class="results-table-container">
                <table id="resultsTable">
                    <thead>
                        <tr>
                            <th>Alias</th>
                            <th>Descripci√≥n</th>
                            <th>Sin√≥nimos Generados</th>
                            <th>Palabras Clave</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="resultsBody">
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Nueva secci√≥n para productos de RISOLU -->
        <div class="risolu-products-section" id="risolusSection" style="display: none;">
            <div class="risolu-header">
                <h2>üõí Productos en Tienda RISOLU</h2>
                <p>Productos encontrados en la tienda online de RISOLU</p>
            </div>
            <div class="risolu-products-container" id="risolusContainer">
                <!-- Los productos se llenar√°n din√°micamente -->
            </div>
        </div>

        <div class="stats-section" id="statsSection" style="display: none;">
            <div class="stats-grid">
                <div class="stat-card">
                    <h3 id="totalProducts">0</h3>
                    <p>Productos Procesados</p>
                </div>
                <div class="stat-card">
                    <h3 id="totalSynonyms">0</h3>
                    <p>Sin√≥nimos Generados</p>
                </div>
                <div class="stat-card">
                    <h3 id="uniqueKeywords">0</h3>
                    <p>Palabras Clave √önicas</p>
                </div>
            </div>
        </div>

        <!-- Nueva secci√≥n para gesti√≥n de memoria de sin√≥nimos -->
        <div class="memory-section" id="memorySection" style="display: block;">
            <div class="memory-header">
                <h2>üíæ Gesti√≥n de Memoria de Sin√≥nimos</h2>
                <p>Sistema inteligente de memoria para mantener consistencia en sin√≥nimos</p>
            </div>
            
            <div class="memory-stats">
                <div class="memory-stat-card">
                    <h3 id="memoryTotalProducts">0</h3>
                    <p>Productos en Memoria</p>
                </div>
                <div class="memory-stat-card">
                    <h3 id="memoryTotalSynonyms">0</h3>
                    <p>Sin√≥nimos Almacenados</p>
                </div>
                <div class="memory-stat-card">
                    <h3 id="memorySize">0 KB</h3>
                    <p>Tama√±o de Memoria</p>
                </div>
            </div>
            
            <div class="memory-controls">
                <div class="memory-actions">
                    <button class="btn-memory" onclick="refreshMemoryStats()">üîÑ Actualizar Estad√≠sticas</button>
                    <button class="btn-memory" onclick="showMostUsedProducts()">üìà Productos M√°s Usados</button>
                    <button class="btn-memory" onclick="adjustSimilarityThreshold()">‚öôÔ∏è Ajustar Similitud</button>
                </div>
                
                <div class="memory-export">
                    <h4>Exportar Base de Datos:</h4>
                    <button class="btn-export-memory" onclick="exportSynonymMemory('json')">üìã JSON</button>
                    <button class="btn-export-memory" onclick="exportSynonymMemory('csv')">üìÑ CSV</button>
                    <button class="btn-export-memory" onclick="exportSynonymMemory('excel')">üìä Excel</button>
                </div>
                
                <div class="memory-import">
                    <h4>Importar Base de Datos:</h4>
                    <input type="file" id="memoryImportInput" accept=".json" style="display: none;" onchange="handleMemoryImport(this)">
                    <button class="btn-import-memory" onclick="document.getElementById('memoryImportInput').click()">üì• Importar JSON</button>
                    <button class="btn-clear-memory" onclick="clearSynonymMemory()">üóëÔ∏è Limpiar Memoria</button>
                </div>
            </div>
            
            <div class="similarity-settings" id="similaritySettings" style="display: none;">
                <h4>‚öôÔ∏è Configuraci√≥n de Similitud</h4>
                <div class="similarity-control">
                    <label>Umbral de Similitud: <span id="similarityValue">0.7</span></label>
                    <input type="range" id="similaritySlider" min="0.1" max="1.0" step="0.1" value="0.7" onchange="updateSimilarityThreshold(this.value)">
                    <small>Valores m√°s altos requieren mayor similitud para sugerir productos existentes</small>
                </div>
            </div>
            
            <div class="most-used-products" id="mostUsedProducts" style="display: none;">
                <h4>üìà Productos M√°s Utilizados</h4>
                <div id="mostUsedList" class="products-list">
                    <!-- Se llenar√° din√°micamente -->
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>