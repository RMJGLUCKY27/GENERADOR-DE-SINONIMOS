<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RISOLU - Generador de SinÃ³nimos para Productos Industriales</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ­ RISOLU - Generador de SinÃ³nimos</h1>
            <p>Optimiza la bÃºsqueda de productos industriales con sinÃ³nimos inteligentes</p>
            <small>Especializado en AutomatizaciÃ³n, Redes Industriales y Equipo ElÃ©ctrico</small>
            <div class="web-status-container">
                <div class="web-control-panel">
                    <span id="webSearchStatus" class="web-status connected">BÃºsqueda Web Activa ğŸŒ</span>
                    <div class="web-controls">
                        <button id="toggleWebSearchBtn" class="btn-web-control start" onclick="toggleWebSearch()">
                            ğŸ”„ Alternar BÃºsqueda
                        </button>
                        <button id="configureUrlsBtn" class="btn-web-control config" onclick="configureSearchUrls()">
                            âš™ï¸ Configurar URLs
                        </button>
                        <button id="testSearchBtn" class="btn-web-control test" onclick="searchInMultipleSites('test martillo')">
                            ğŸ§ª Probar BÃºsqueda
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <div class="upload-section">
            <div class="upload-box" id="uploadBox">
                <input type="file" id="fileInput" accept=".xlsx,.xls,.csv" style="display: none;">
                <div class="upload-content">
                    <div class="upload-icon">ğŸ“Š</div>
                    <p>Arrastra y suelta tu archivo Excel aquÃ­</p>
                    <p>o <button class="btn-upload" onclick="document.getElementById('fileInput').click()">Selecciona un archivo</button></p>
                    <small>Formatos soportados: .xlsx, .xls, .csv</small>
                </div>
            </div>
        </div>

        <div class="controls-section" id="controlsSection" style="display: none;">
            <h3>ğŸ“‹ Vista Previa del Archivo y SelecciÃ³n de Columnas</h3>
            
            <!-- Vista previa de datos -->
            <div class="preview-container">
                <div class="preview-info">
                    <span id="fileInfo">Archivo cargado: <strong id="fileName"></strong></span>
                    <span id="rowCount">Filas: <strong id="totalRows"></strong></span>
                </div>
                
                <div class="preview-table-container">
                    <table id="previewTable" class="preview-table">
                        <thead id="previewHeader"></thead>
                        <tbody id="previewBody"></tbody>
                    </table>
                </div>
            </div>
            
            <!-- Controles de selecciÃ³n -->
            <div class="column-selection">
                <div class="selection-instructions">
                    <h4>ğŸ‘† Haz clic en los encabezados de columna para seleccionarlas:</h4>
                    <div class="selection-indicators">
                        <span class="indicator alias-indicator">ğŸ·ï¸ Alias/CÃ³digo</span>
                        <span class="indicator description-indicator">ğŸ“ DescripciÃ³n</span>
                    </div>
                </div>
                
                <div class="selected-columns">
                    <div class="selected-column">
                        <label>Columna de Alias/CÃ³digo:</label>
                        <span id="selectedAlias" class="selected-value">Ninguna seleccionada</span>
                    </div>
                    <div class="selected-column">
                        <label>Columna de DescripciÃ³n:</label>
                        <span id="selectedDescription" class="selected-value">Ninguna seleccionada</span>
                    </div>
                </div>
                
                <button class="btn-process" id="processBtn" onclick="generateSynonyms()" disabled>
                    Generar SinÃ³nimos
                </button>
            </div>
        </div>

        <div class="search-section" id="searchSection" style="display: none;">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Buscar productos, alias o sinÃ³nimos...">
                <button class="btn-search" onclick="searchProducts()">ğŸ”</button>
            </div>
            <div class="filter-options">
                <label>
                    <input type="checkbox" id="searchAlias" checked> Buscar en alias
                </label>
                <label>
                    <input type="checkbox" id="searchDescription" checked> Buscar en descripciÃ³n
                </label>
                <label>
                    <input type="checkbox" id="searchSynonyms" checked> Buscar en sinÃ³nimos
                </label>
            </div>
        </div>

        <div class="results-section" id="resultsSection" style="display: none;">
            <div class="results-header">
                <h2>Resultados <span id="resultsCount"></span></h2>
                <div class="export-options">
                    <button class="btn-export" onclick="exportResults('excel')">ğŸ“Š Exportar a Excel</button>
                    <button class="btn-export" onclick="exportResults('csv')">ğŸ“„ Exportar a CSV</button>
                </div>
            </div>
            <div class="results-table-container">
                <table id="resultsTable">
                    <thead>
                        <tr>
                            <th>Alias</th>
                            <th>DescripciÃ³n</th>
                            <th>SinÃ³nimos Generados</th>
                            <th>Palabras Clave</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="resultsBody">
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Nueva secciÃ³n para productos de RISOLU -->
        <div class="risolu-products-section" id="risolusSection" style="display: none;">
            <div class="risolu-header">
                <h2>ğŸ›’ Productos en Tienda RISOLU</h2>
                <p>Productos encontrados en la tienda online de RISOLU</p>
            </div>
            <div class="risolu-products-container" id="risolusContainer">
                <!-- Los productos se llenarÃ¡n dinÃ¡micamente -->
            </div>
        </div>

        <div class="stats-section" id="statsSection" style="display: none;">
            <div class="stats-grid">
                <div class="stat-card">
                    <h3 id="totalProducts">0</h3>
                    <p>Productos Procesados</p>
                </div>
                <div class="stat-card">
                    <h3 id="totalSynonyms">0</h3>
                    <p>SinÃ³nimos Generados</p>
                </div>
                <div class="stat-card">
                    <h3 id="uniqueKeywords">0</h3>
                    <p>Palabras Clave Ãšnicas</p>
                </div>
            </div>
        </div>

        <!-- Nueva secciÃ³n para gestiÃ³n de memoria de sinÃ³nimos -->
        <div class="memory-section" id="memorySection" style="display: block;">
            <div class="memory-header">
                <h2>ğŸ’¾ GestiÃ³n de Memoria de SinÃ³nimos</h2>
                <p>Sistema inteligente de memoria para mantener consistencia en sinÃ³nimos</p>
            </div>
            
            <div class="memory-stats">
                <div class="memory-stat-card">
                    <h3 id="memoryTotalProducts">0</h3>
                    <p>Productos en Memoria</p>
                </div>
                <div class="memory-stat-card">
                    <h3 id="memoryTotalSynonyms">0</h3>
                    <p>SinÃ³nimos Almacenados</p>
                </div>
                <div class="memory-stat-card">
                    <h3 id="memorySize">0 KB</h3>
                    <p>TamaÃ±o de Memoria</p>
                </div>
            </div>
            
            <div class="memory-controls">
                <div class="memory-actions">
                    <button class="btn-memory" onclick="refreshMemoryStats()">ğŸ”„ Actualizar EstadÃ­sticas</button>
                    <button class="btn-memory" onclick="showMostUsedProducts()">ğŸ“ˆ Productos MÃ¡s Usados</button>
                    <button class="btn-memory" onclick="adjustSimilarityThreshold()">âš™ï¸ Ajustar Similitud</button>
                </div>
                
                <div class="memory-export">
                    <h4>Exportar Base de Datos:</h4>
                    <button class="btn-export-memory" onclick="exportSynonymMemory('json')">ğŸ“‹ JSON</button>
                    <button class="btn-export-memory" onclick="exportSynonymMemory('csv')">ğŸ“„ CSV</button>
                    <button class="btn-export-memory" onclick="exportSynonymMemory('excel')">ğŸ“Š Excel</button>
                </div>
                
                <div class="memory-import">
                    <h4>Importar Base de Datos:</h4>
                    <input type="file" id="memoryImportInput" accept=".json" style="display: none;" onchange="handleMemoryImport(this)">
                    <button class="btn-import-memory" onclick="document.getElementById('memoryImportInput').click()">ğŸ“¥ Importar JSON</button>
                    <button class="btn-clear-memory" onclick="clearSynonymMemory()">ğŸ—‘ï¸ Limpiar Memoria</button>
                </div>
            </div>
            
            <div class="similarity-settings" id="similaritySettings" style="display: none;">
                <h4>âš™ï¸ ConfiguraciÃ³n de Similitud</h4>
                <div class="similarity-control">
                    <label>Umbral de Similitud: <span id="similarityValue">0.7</span></label>
                    <input type="range" id="similaritySlider" min="0.1" max="1.0" step="0.1" value="0.7" onchange="updateSimilarityThreshold(this.value)">
                    <small>Valores mÃ¡s altos requieren mayor similitud para sugerir productos existentes</small>
                </div>
            </div>
            
            <div class="most-used-products" id="mostUsedProducts" style="display: none;">
                <h4>ğŸ“ˆ Productos MÃ¡s Utilizados</h4>
                <div id="mostUsedList" class="products-list">
                    <!-- Se llenarÃ¡ dinÃ¡micamente -->
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>